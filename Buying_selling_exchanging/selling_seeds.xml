<?xml version="1.0"?>
<vxml version="2.0">

<var name="selected_seed_type" expr="'undefined'"/>
<var name="selected_seed_amount" expr=""/>
<var name="selected_phone_number" expr=""/>

<form id="select_seed_type">
    <field name="seed_type_input">
    <prompt bargein="true">You have selected that you are interested in selling seeds. We are currently supporting three types of seeds: Wheat, Oat, and Rye.</prompt>
    <prompt>Please select which type of seed you want to sell.</prompt>
    <option value="Wheat">Wheat</option>
    <option value="Oat">Oat</option>
    <option value="Rye">Rye</option>
    <noinput>Sorry, I didn't catch that.<reprompt/></noinput>
    <nomatch>Sorry, that does not match any of the options.<reprompt/></nomatch>
    </field>

    <filled>
      <assign name="selected_seed_type" expr="seed_type_input"/>   
      <goto next="#check_seed_input"/>
    </filled>
</form>

<form id="check_seed_input">
    <field name="check_selected_seed_type">
        <prompt>You have selected <value expr="selected_seed_type"/>.Do you want to proceed? </prompt>
        <option value="yes">Yes</option>
        <option value="no">No</option>
        <noinput>Sorry, I didn't catch that.<reprompt/></noinput>
        <nomatch>Sorry, that does not match any of the options.<reprompt/></nomatch>
    </field>

    <filled>
      <if cond="check_selected_seed_type == 'yes'">
	      <prompt>You have selected that you want to sell <value expr="selected_seed_type"/>.</prompt>
        <goto next="#select_amount"/>
      <elseif cond="check_selected_seed_type == 'no'"/>
        <goto next="#select_seed_type"/>
      <else>
        <prompt>Invalid response. Please try again.</prompt>
      </else>
      </if>
    </filled>
</form>

<form id="select_amount">
      <field name="amount_input" type="number">
            <prompt>How much kilograms of <value expr="selected_seed_type"/> do you want to sell?</prompt>
            <noinput>Sorry, I didn't catch that.<reprompt/></noinput>
            <nomatch>Sorry, that does not match any of the options.<reprompt/></nomatch>

            <filled>
                <assign name="selected_seed_amount" expr="amount_input"/>   
                <goto next="#check_amount"/>
            </filled>
        </field>
</form>
<form id="check_amount">
    <field name="check_selected_amount">
        <prompt>You have selected <value expr="selected_seed_amount"/> kilograms. Do you want to proceed? </prompt>
        <option value="yes">Yes</option>
        <option value="no">No</option>
        <noinput>Sorry, I didn't catch that.<reprompt/></noinput>
        <nomatch>Sorry, that does not match any of the options.<reprompt/></nomatch>
    </field>

    <filled>
      <if cond="check_selected_amount == 'yes'">
        <prompt>You have selected that you want to sell <value expr="selected_seed_amount"/> 
kilograms of <value expr="selected_seed_type"/>.</prompt>
        <goto next="#select_phone_number"/>
      <elseif cond="check_selected_amount == 'no'"/>
        <goto next="#select_amount"/>
      <else>
        <prompt>Invalid response. Please try again.</prompt>
      </else>
      </if>
    </filled>
</form>

<form id="select_phone_number">
    <field name="input_phone_number" type="digits">
        <prompt bargein="true">In order for people to contact you, please enter your phone number, including the country code.</prompt>
        <noinput>Sorry, I didn't catch that.<reprompt/></noinput>
        <filled>
            <assign name="selected_phone_number" expr="input_phone_number"/>   
            <goto next="#check_phone_number"/>
        </filled>
    </field>
</form>

<form id="check_phone_number">
    <field name="check_selected_phone_number">
        <prompt>Your phone number is <value expr="selected_phone_number"/>. Is that correct? </prompt>
        <option value="yes">Yes</option>
        <option value="no">No</option>
        <noinput>Sorry, I didn't catch that.<reprompt/></noinput>
        <nomatch>Sorry, that does not match any of the options.<reprompt/></nomatch>
    </field>

    <filled>
      <if cond="check_selected_phone_number == 'yes'">
        <goto next ="#submission"/>
      <elseif cond="check_selected_phone_number == 'no'"/>
        <goto next="#select_phone_number"/>
      <else>
        <prompt>Invalid response. Please try again.</prompt>
      </else>
      </if>
    </filled>
</form>

<form id="submission">
    <field name="submission_input">
        <prompt>Great. We have received your request to sell <value expr="selected_seed_amount"/> kilograms of <value expr="selected_seed_type"/>. If someone is interested in buying your seeds, they will be able to contact you under <value expr="selected_phone_number"/>. Do you want to submit this request?</prompt>
        <option value="yes">Yes</option>
        <option value="no">No</option>
        <noinput>Sorry, I didn't catch that.<reprompt/></noinput>
        <nomatch>Sorry, that does not match any of the options.<reprompt/></nomatch>
    </field>
    <filled>
        <if cond="submission_input == 'yes'">
            <prompt>Your request was submitted. Thank you.</prompt>
	    <goto next="main_menu.xml"/>
        <elseif cond="submission_input == 'no'"/>
            <prompt>You have chosen not to proceed. You will be forwarded back to the main menu.</prompt>
            <goto next="main_menu.xml"/>
        <else>
            <prompt>Invalid response. Please try again.</prompt>
	</else>
        </if>
    </filled>
</form>
</vxml>